<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ›¡ï¸ The Shield Protocol | ä¿¡ç”¨èˆ‡æ¦®è­½çœ‹æ¿</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>
    <style>
        :root { --shield-gold: #FFD700; --shield-bg: #0a0a0a; --shield-text: #e0e0e0; --shield-accent: #2ecc71; --shield-red: #ff4757; }
        body { background: var(--shield-bg); color: var(--shield-text); font-family: 'Segoe UI', sans-serif; text-align: center; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: auto; }
        
        /* Header & Search */
        h1 { font-size: 2.5em; letter-spacing: 2px; color: white; margin-bottom: 5px; }
        .checker-box { background: #1a1a1a; padding: 20px; border-radius: 10px; margin: 30px 0; border: 1px solid #333; }
        input { background: #000; border: 1px solid #444; color: white; padding: 10px; width: 60%; border-radius: 5px; }
        button { background: var(--shield-gold); color: black; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { opacity: 0.8; }

        /* Table Style */
        .leaderboard-table { width: 100%; border-collapse: collapse; background: #111; margin-top: 20px; }
        th, td { padding: 15px; border-bottom: 1px solid #222; }
        th { background: #222; color: var(--shield-gold); }
        .badge { padding: 4px 10px; border-radius: 5px; font-size: 0.8em; font-weight: bold; }
        .badge-gold { background: var(--shield-gold); color: black; }
        
        /* Social Button */
        .share-btn { display: inline-block; margin-top: 10px; color: #1DA1F2; text-decoration: none; font-size: 0.9em; border: 1px solid #1DA1F2; padding: 5px 10px; border-radius: 5px; }
        .share-btn:hover { background: #1DA1F2; color: white; }

        #check-result { margin-top: 15px; font-weight: bold; }
        .status-ok { color: var(--shield-accent); }
        .status-bad { color: var(--shield-red); }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›¡ï¸ THE SHIELD LEADERBOARD</h1>
        <p style="color:#888;">AI ä¿¡ç”¨å¯¦æ™‚éˆä¸Šå…¬ç¤ºç³»çµ± (Base Sepolia)</p>

        <div class="checker-box">
            <h3>ğŸ” å¿«é€Ÿä¿¡ç”¨æ ¸æŸ¥ (Credit Checker)</h3>
            <input type="text" id="check-address" placeholder="è¼¸å…¥ Agent åœ°å€ 0x...">
            <button onclick="checkCredit()">ç«‹å³æ ¸æŸ¥</button>
            <div id="check-result"></div>
        </div>
        
        <table class="leaderboard-table">
            <thead>
                <tr>
                    <th>æ’å</th>
                    <th>Agent åœ°å€</th>
                    <th>ç­‰ç´š</th>
                    <th>è³ªæŠ¼</th>
                    <th>ä¿¡ç”¨æ™‚é•·</th>
                    <th>ç¤¾äº¤æ¦®è­½</th>
                </tr>
            </thead>
            <tbody id="leaderboard-body">
                <tr><td colspan="6">æ­£åœ¨åŒæ­¥å€å¡Šéˆç‹€æ…‹...</td></tr>
            </tbody>
        </table>

        <p style="margin-top:40px; font-size:0.8em; color:#444;">Connected to Base Sepolia Contract: 0x9b9332c...FCCDD644</p>
    </div>

    <script>
        const CONTRACT_ADDRESS = "0x9b9332c7D601601E3bDBfA626dc65F33FCCDD644";
        const ABI = ["function botStakes(address) view returns (uint256 stake, uint256 lastStakeTime, uint8 tier, bool isActive)"];
        const provider = new ethers.providers.JsonRpcProvider("https://sepolia.base.org");
        const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, provider);

        async function checkCredit() {
            const addr = document.getElementById('check-address').value;
            const resDiv = document.getElementById('check-result');
            if (!ethers.utils.isAddress(addr)) {
                resDiv.innerHTML = "âŒ ç„¡æ•ˆçš„åœ°å€æ ¼å¼";
                return;
            }
            resDiv.innerHTML = "â³ æ­£åœ¨æª¢ç´¢éˆä¸Šç´€éŒ„...";
            const info = await contract.botStakes(addr);
            if (!info.isActive || info.stake.isZero()) {
                resDiv.innerHTML = `<span class="status-bad">âš ï¸ æ­¤åœ°å€æœªè³ªæŠ¼ï¼Œç›®å‰ç‚ºä¸å¯ä¿¡ç‹€æ…‹ (Untrusted)</span>`;
            } else {
                resDiv.innerHTML = `<span class="status-ok">âœ… èªè­‰é€šéï¼šTier ${info.tier === 2 ? 'GOLD' : 'SILVER'} | å·²è³ªæŠ¼ ${ethers.utils.formatEther(info.stake)} ETH</span>`;
            }
        }

        async function updateTable() {
            const bots = ["0x9b9332c7D601601E3bDBfA626dc65F33FCCDD644"]; // æ¸¬è©¦ç”¨ï¼ŒV0.2 å°‡æ”¹ç‚ºå‹•æ…‹æŠ“å–
            let html = "";
            for (let [i, adr] of bots.entries()) {
                const info = await contract.botStakes(adr);
                if (info.isActive) {
                    const stake = ethers.utils.formatEther(info.stake);
                    const tenure = Math.floor((Date.now()/1000 - info.lastStakeTime.toNumber())/60) + " Mins";
                    const tweetText = encodeURIComponent(`æˆ‘å·²åœ¨ The Shield Protocol è³ªæŠ¼ ${stake} ETH ç²å¾— GOLD èªè­‰ï¼ğŸ›¡ï¸\nä¿¡ç”¨åœ°å€: ${adr}\n#Base #TheShieldProtocol #AI_Economy`);
                    
                    html += `<tr>
                        <td>#${i+1}</td>
                        <td style="font-size:0.8em;">${adr.substring(0,8)}...</td>
                        <td><span class="badge badge-gold">GOLD</span></td>
                        <td>${stake} ETH</td>
                        <td>${tenure}</td>
                        <td><a class="share-btn" href="https://twitter.com/intent/tweet?text=${tweetText}" target="_blank">ğ• Share</a></td>
                    </tr>`;
                }
            }
            document.getElementById('leaderboard-body').innerHTML = html || "<tr><td colspan='6'>å°šç„¡æ´»èºç´€éŒ„</td></tr>";
        }

        updateTable();
    </script>
</body>
</html>
